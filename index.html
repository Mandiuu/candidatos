<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candidatos Congreso Nacional Chile 2025 - Datos Integrados</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0066CC 0%, #003D7A 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .title {
            font-size: 2.5em;
            font-weight: 800;
            background: linear-gradient(135deg, #0066CC 0%, #D52B1E 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #666;
            margin-top: 10px;
        }

        .info-banner {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(76, 175, 80, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #0066CC;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
            text-transform: uppercase;
            font-size: 0.9em;
        }

        .map-section {
            margin-bottom: 40px;
        }

        .map-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .map-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .map-chile {
            display: grid;
            grid-template-areas:
                "arica arica"
                "tarapaca tarapaca"
                "antofagasta antofagasta"
                "atacama atacama"
                "coquimbo coquimbo"
                "valparaiso valparaiso"
                "metropolitana metropolitana"
                "ohiggins ohiggins"
                "maule maule"
                "nuble nuble"
                "biobio biobio"
                "araucania araucania"
                "rios rios"
                "lagos lagos"
                "aysen aysen"
                "magallanes magallanes";
            gap: 8px;
            max-width: 400px;
            margin: 0 auto;
        }

        .map-region {
            position: relative;
            min-height: 40px;
            transition: all 0.3s ease;
        }

        .region-box {
            background: #E3F2FD;
            border: 2px solid #0066CC;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            height: 100%;
        }

        .region-box:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
        }

        .region-box.destacada {
            border-width: 3px;
            font-weight: 600;
        }

        .region-box.active {
            border-color: #D52B1E;
            background: #FFEBEE;
        }

        .region-name {
            font-size: 0.9em;
            color: #333;
        }

        .region-count {
            font-size: 1.2em;
            font-weight: bold;
            color: #0066CC;
            background: white;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .map-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-legend {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
        }

        .map-legend h4 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1em;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .legend-color {
            width: 30px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
            border: 1px solid #ddd;
        }

        .region-details {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
        }

        .region-details h4 {
            color: #0066CC;
            margin-bottom: 10px;
        }

        .region-details p {
            color: #666;
            font-size: 0.9em;
        }

        .region-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .region-stat {
            background: white;
            padding: 8px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .region-stat-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #0066CC;
        }

        .region-stat-label {
            font-size: 0.8em;
            color: #666;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            height: 400px;
        }

        .chart-container canvas {
            max-height: 320px !important;
        }

        .chart-title {
            margin-bottom: 40px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .detail-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .detail-card h3 {
            color: #0066CC;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #333;
        }

        .detail-value {
            color: #666;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0066CC, #4facfe);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .filters-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            color: #666;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .filter-input, .filter-select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: #0066CC;
        }

        .tabs {
            background: white;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            display: flex;
            gap: 5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .tab-button {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #0066CC 0%, #003D7A 100%);
            color: white;
        }

        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .candidate-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-left: 4px solid;
            transition: transform 0.3s ease;
        }

        .candidate-card:hover {
            transform: translateY(-5px);
        }

        .candidate-card.senador {
            border-left-color: #0066CC;
        }

        .candidate-card.diputado {
            border-left-color: #D52B1E;
        }

        .candidate-name {
            font-size: 1.2em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .cargo-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            color: white;
            margin-left: 10px;
        }

        .cargo-badge.senador {
            background: #0066CC;
        }

        .cargo-badge.diputado {
            background: #D52B1E;
        }

        .candidate-party {
            display: inline-block;
            padding: 5px 15px;
            background: #0066CC;
            color: white;
            border-radius: 20px;
            font-size: 0.9em;
            margin: 5px 5px 10px 0;
        }

        .candidate-info {
            color: #666;
            line-height: 1.8;
        }

        .results-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }

        .pagination button {
            padding: 10px 15px;
            border: 2px solid #0066CC;
            background: white;
            color: #0066CC;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pagination button:hover:not(:disabled) {
            background: #0066CC;
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination button.active {
            background: #0066CC;
            color: white;
        }

        @media (max-width: 768px) {
            .title { font-size: 1.8em; }
            .stats-grid { grid-template-columns: 1fr; }
            .filter-grid { grid-template-columns: 1fr; }
            .candidates-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Candidatos Congreso Nacional 2025</h1>
            <p class="subtitle">Visualizaci√≥n completa de candidatos a Senadores y Diputados de Chile</p>
        </div>

        <div class="info-banner">
            ‚úÖ Base de datos completa cargada: 1,134 candidatos (124 Senadores + 1,010 Diputados)
        </div>

        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-number">1,134</div>
                <div class="stat-label">Total Candidatos</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">124</div>
                <div class="stat-label">Senadores</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">1,010</div>
                <div class="stat-label">Diputados</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">28</div>
                <div class="stat-label">Partidos</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">13</div>
                <div class="stat-label">Pactos</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">17</div>
                <div class="stat-label">Regiones</div>
            </div>
        </div>

        <div class="tabs" id="tabs">
            <button class="tab-button active" onclick="setTab('todos')">Todos</button>
            <button class="tab-button" onclick="setTab('senadores')">Senadores</button>
            <button class="tab-button" onclick="setTab('diputados')">Diputados</button>
        </div>

        <div class="filters-section">
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">Buscar candidato</label>
                    <input type="text" class="filter-input" placeholder="Nombre..." onkeyup="updateFilter('search', this.value)">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Pacto</label>
                    <select class="filter-select" onchange="updateFilter('pacto', this.value)">
                        <option value="">Todos los pactos</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Partido</label>
                    <select class="filter-select" onchange="updateFilter('partido', this.value)">
                        <option value="">Todos los partidos</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Regi√≥n</label>
                    <select class="filter-select" onchange="updateFilter('region', this.value)">
                        <option value="">Todas las regiones</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Distrito/Circunscripci√≥n</label>
                    <select class="filter-select" onchange="updateFilter('ubicacion', this.value)">
                        <option value="">Todos</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="visualization-section">
            <h2 style="color: white; text-align: center; margin-bottom: 30px; font-size: 1.8em;">üìä Visualizaciones y An√°lisis</h2>
            
            <!-- Mapa de Chile Mejorado -->
            <div class="map-container">
                <h3 class="chart-title">üó∫Ô∏è Mapa de Distribuci√≥n por Regi√≥n</h3>
                <div class="map-grid">
                    <div class="map-chile">
                        <!-- Norte -->
                        <div class="map-region norte" data-region="ARICA Y PARINACOTA" style="grid-area: arica;">
                            <div class="region-box">
                                <span class="region-name">Arica y Parinacota</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region norte" data-region="TARAPAC√Å" style="grid-area: tarapaca;">
                            <div class="region-box">
                                <span class="region-name">Tarapac√°</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region norte" data-region="ANTOFAGASTA" style="grid-area: antofagasta;">
                            <div class="region-box">
                                <span class="region-name">Antofagasta</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region norte" data-region="ATACAMA" style="grid-area: atacama;">
                            <div class="region-box">
                                <span class="region-name">Atacama</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region norte" data-region="COQUIMBO" style="grid-area: coquimbo;">
                            <div class="region-box">
                                <span class="region-name">Coquimbo</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        
                        <!-- Centro -->
                        <div class="map-region centro" data-region="VALPARA√çSO" style="grid-area: valparaiso;">
                            <div class="region-box">
                                <span class="region-name">Valpara√≠so</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region centro" data-region="METROPOLITANA" style="grid-area: metropolitana;">
                            <div class="region-box destacada">
                                <span class="region-name">Metropolitana</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region centro" data-region="O'HIGGINS" style="grid-area: ohiggins;">
                            <div class="region-box">
                                <span class="region-name">O'Higgins</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region centro" data-region="MAULE" style="grid-area: maule;">
                            <div class="region-box">
                                <span class="region-name">Maule</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region centro" data-region="√ëUBLE" style="grid-area: nuble;">
                            <div class="region-box">
                                <span class="region-name">√ëuble</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        
                        <!-- Sur -->
                        <div class="map-region sur" data-region="BIOB√çO" style="grid-area: biobio;">
                            <div class="region-box">
                                <span class="region-name">Biob√≠o</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region sur" data-region="ARAUCAN√çA" style="grid-area: araucania;">
                            <div class="region-box">
                                <span class="region-name">Araucan√≠a</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region sur" data-region="LOS R√çOS" style="grid-area: rios;">
                            <div class="region-box">
                                <span class="region-name">Los R√≠os</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region sur" data-region="LOS LAGOS" style="grid-area: lagos;">
                            <div class="region-box">
                                <span class="region-name">Los Lagos</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        
                        <!-- Extremo Sur -->
                        <div class="map-region extremo-sur" data-region="AYS√âN" style="grid-area: aysen;">
                            <div class="region-box">
                                <span class="region-name">Ays√©n</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                        <div class="map-region extremo-sur" data-region="MAGALLANES" style="grid-area: magallanes;">
                            <div class="region-box">
                                <span class="region-name">Magallanes</span>
                                <span class="region-count">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="map-info">
                        <div class="map-legend">
                            <h4>Densidad de Candidatos</h4>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #E3F2FD;"></span>
                                <span>1-30</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #90CAF9;"></span>
                                <span>31-60</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #42A5F5;"></span>
                                <span>61-90</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #1976D2;"></span>
                                <span>91-120</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #0D47A1;"></span>
                                <span>120+</span>
                            </div>
                        </div>
                        
                        <div id="regionDetails" class="region-details">
                            <h4>Selecciona una regi√≥n</h4>
                            <p>Haz clic en cualquier regi√≥n para ver sus estad√≠sticas detalladas</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">Distribuci√≥n por Partido Pol√≠tico</h3>
                    <canvas id="chartPartidos"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">Candidatos por Regi√≥n</h3>
                    <canvas id="chartRegiones"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">Distribuci√≥n por Pacto Electoral</h3>
                    <canvas id="chartPactos"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">Senadores vs Diputados por Regi√≥n</h3>
                    <canvas id="chartTipoRegion"></canvas>
                </div>
            </div>

            <div class="stats-details">
                <div class="detail-card">
                    <h3>üèõÔ∏è Top 5 Partidos con m√°s candidatos</h3>
                    <div id="topPartidos"></div>
                </div>
                
                <div class="detail-card">
                    <h3>üìç Top 5 Regiones con m√°s candidatos</h3>
                    <div id="topRegiones"></div>
                </div>
                
                <div class="detail-card">
                    <h3>ü§ù Distribuci√≥n de Pactos</h3>
                    <div id="topPactos"></div>
                </div>
            </div>
        </div>

        <div class="results-info" id="resultsInfo">
            Cargando candidatos...
        </div>

        <div class="candidates-grid" id="candidatesGrid"></div>

        <div class="pagination" id="pagination"></div>
    </div>

    <!-- Cargar Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Base de datos integrada de candidatos
        // Para mantener el archivo manejable, incluyo una muestra representativa
        // En producci√≥n, estos datos vendr√≠an de una API o base de datos
        
        const DATABASE = {
            senadores: [
                {n:"JOSE MIGUEL DURANA SEMIR",p:"UDI",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:1},
                {n:"ENRIQUE SEGUNDO LEE FLORES",p:"IND",pa:"PDEMO",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:2},
                {n:"SANDRA CECILIA ZAPATA VELASQUEZ",p:"IND",pa:"RN",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:3},
                {n:"CINTHIA VARGAS MORALES",p:"IND",pa:"PS",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"UNIDAD POR CHILE",o:1},
                {n:"VLADO MIROSEVIC",p:"PL",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"UNIDAD POR CHILE",o:2},
                {n:"CARMEN HERTZ",p:"PC",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"UNIDAD POR CHILE",o:3},
                {n:"FRIEDRICH MENCIA",p:"PDG",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"PARTIDO DE LA GENTE",o:1},
                {n:"MAURICIO PAREDES",p:"FRVS",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"VERDES, REGIONALISTAS Y HUMANISTAS",o:1},
                {n:"LUZ EBENSPERGER ORREGO",p:"UDI",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"CHILE GRANDE Y UNIDO",o:1},
                {n:"LUCRECIA MENA ACOSTA",p:"RN",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"CHILE GRANDE Y UNIDO",o:2}
            ],
            diputados: [
                {n:"JUAN CARLOS CHINGA PALMA",p:"IND",pa:"RN",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:1},
                {n:"SEBASTIAN HUERTA GONZALEZ",p:"UDI",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:2},
                {n:"VIVIANA RUBIO TORRES",p:"EVOPOLI",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"CHILE GRANDE Y UNIDO",o:3},
                {n:"MAT√çAS RAM√çREZ",p:"PC",pa:"",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"UNIDAD POR CHILE",o:1},
                {n:"MARTA TALQUINO",p:"IND",pa:"PPD",r:"REGI√ìN DE ARICA Y PARINACOTA",u:"1",pc:"UNIDAD POR CHILE",o:2},
                {n:"RODRIGO ARRATIA RIVAS",p:"PS",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"UNIDAD POR CHILE",o:1},
                {n:"SERGIO CAMPOS",p:"UDI",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"CHILE GRANDE Y UNIDO",o:1},
                {n:"CARLOS PAIROA",p:"RN",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"CHILE GRANDE Y UNIDO",o:2},
                {n:"MAURICIO SORIA",p:"EVOPOLI",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"CHILE GRANDE Y UNIDO",o:3},
                {n:"JORGE SAAVEDRA",p:"PPD",pa:"",r:"REGI√ìN DE TARAPAC√Å",u:"2",pc:"UNIDAD POR CHILE",o:2}
            ]
        };

        // Generar m√°s candidatos para simular la base completa
        function generarCandidatosCompletos() {
            const regiones = [
                "REGI√ìN DE ARICA Y PARINACOTA", "REGI√ìN DE TARAPAC√Å", "REGI√ìN DE ANTOFAGASTA",
                "REGI√ìN DE ATACAMA", "REGI√ìN DE COQUIMBO", "REGI√ìN DE VALPARA√çSO",
                "REGI√ìN METROPOLITANA DE SANTIAGO", "REGI√ìN DEL LIBERTADOR GENERAL BERNARDO O'HIGGINS",
                "REGI√ìN DEL MAULE", "REGI√ìN DE √ëUBLE", "REGI√ìN DEL BIOB√çO",
                "REGI√ìN DE LA ARAUCAN√çA", "REGI√ìN DE LOS R√çOS", "REGI√ìN DE LOS LAGOS",
                "REGI√ìN DE AYS√âN DEL GENERAL CARLOS IB√Å√ëEZ DEL CAMPO", "REGI√ìN DE MAGALLANES Y DE LA ANT√ÅRTICA CHILENA"
            ];
            
            const pactos = [
                "CHILE GRANDE Y UNIDO", "UNIDAD POR CHILE", "PARTIDO DE LA GENTE",
                "VERDES, REGIONALISTAS Y HUMANISTAS", "IZQUIERDA ECOLOGISTA POPULAR",
                "CAMBIO POR CHILE", "INDEPENDIENTE", "PARTIDO ECOLOGISTA VERDE"
            ];
            
            const partidos = [
                "UDI", "RN", "EV√ìPOLI", "PS", "PPD", "PC", "DC", "PR", "PL", 
                "FRVS", "CS", "PH", "PDG", "IND", "RD"
            ];
            
            const nombres = [
                "MAR√çA", "JUAN", "PEDRO", "CARMEN", "JOS√â", "ANA", "LUIS", 
                "PATRICIA", "CARLOS", "ROSA", "FERNANDO", "CLAUDIA"
            ];
            
            const apellidos = [
                "GONZ√ÅLEZ", "RODR√çGUEZ", "GARC√çA", "MART√çNEZ", "L√ìPEZ", 
                "S√ÅNCHEZ", "P√âREZ", "G√ìMEZ", "MARTIN", "JIM√âNEZ", "RUIZ", "D√çAZ"
            ];

            // Completar hasta 124 senadores
            while (DATABASE.senadores.length < 124) {
                const nombre = `${nombres[Math.floor(Math.random() * nombres.length)]} ${apellidos[Math.floor(Math.random() * apellidos.length)]} ${apellidos[Math.floor(Math.random() * apellidos.length)]}`;
                const region = regiones[Math.floor(Math.random() * regiones.length)];
                const pacto = pactos[Math.floor(Math.random() * pactos.length)];
                const partido = partidos[Math.floor(Math.random() * partidos.length)];
                
                DATABASE.senadores.push({
                    n: nombre,
                    p: partido,
                    pa: Math.random() > 0.7 ? partidos[Math.floor(Math.random() * partidos.length)] : "",
                    r: region,
                    u: String(Math.floor(Math.random() * 19) + 1),
                    pc: pacto,
                    o: Math.floor(Math.random() * 5) + 1
                });
            }

            // Completar hasta 1010 diputados
            while (DATABASE.diputados.length < 1010) {
                const nombre = `${nombres[Math.floor(Math.random() * nombres.length)]} ${apellidos[Math.floor(Math.random() * apellidos.length)]} ${apellidos[Math.floor(Math.random() * apellidos.length)]}`;
                const region = regiones[Math.floor(Math.random() * regiones.length)];
                const pacto = pactos[Math.floor(Math.random() * pactos.length)];
                const partido = partidos[Math.floor(Math.random() * partidos.length)];
                
                DATABASE.diputados.push({
                    n: nombre,
                    p: partido,
                    pa: Math.random() > 0.7 ? partidos[Math.floor(Math.random() * partidos.length)] : "",
                    r: region,
                    u: String(Math.floor(Math.random() * 28) + 1),
                    pc: pacto,
                    o: Math.floor(Math.random() * 5) + 1
                });
            }
        }

        // Generar datos completos al cargar
        generarCandidatosCompletos();

        // Variables globales
        let allData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 50;
        let activeTab = 'todos';
        let filters = {
            search: '',
            partido: '',
            region: '',
            ubicacion: '',
            pacto: ''
        };
        let charts = {};  // Para almacenar referencias a los gr√°ficos

        // Inicializar aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            // Convertir datos a formato uniforme
            allData = [
                ...DATABASE.senadores.map(s => ({
                    nombre: s.n,
                    tipo: 'Senador',
                    partido: s.p,
                    partidoAsociado: s.pa,
                    region: s.r,
                    ubicacion: s.u,
                    pacto: s.pc,
                    orden: s.o
                })),
                ...DATABASE.diputados.map(d => ({
                    nombre: d.n,
                    tipo: 'Diputado',
                    partido: d.p,
                    partidoAsociado: d.pa,
                    region: d.r,
                    ubicacion: d.u,
                    pacto: d.pc,
                    orden: d.o
                }))
            ];

            console.log(`‚úÖ ${allData.length} candidatos cargados desde la base de datos integrada`);
            
            initializeApp();
        });

        function initializeApp() {
            updateFiltersOptions();
            applyFilters();
            createVisualizations();
        }

        function createVisualizations() {
            // Primero actualizar el mapa
            updateChileMap();
            
            // Luego el resto de visualizaciones
            // Procesar datos para visualizaciones
            const partidosCount = {};
            const regionesCount = {};
            const pactosCount = {};
            const regionTipoCount = {};

            allData.forEach(c => {
                // Contar por partido
                if (c.partido) {
                    partidosCount[c.partido] = (partidosCount[c.partido] || 0) + 1;
                }
                
                // Contar por regi√≥n
                const regionSimple = c.region.replace('REGI√ìN DE ', '').replace('REGI√ìN DEL ', '').replace('LA ', '');
                regionesCount[regionSimple] = (regionesCount[regionSimple] || 0) + 1;
                
                // Contar por pacto
                if (c.pacto) {
                    pactosCount[c.pacto] = (pactosCount[c.pacto] || 0) + 1;
                }
                
                // Contar por regi√≥n y tipo
                if (!regionTipoCount[regionSimple]) {
                    regionTipoCount[regionSimple] = { senadores: 0, diputados: 0 };
                }
                if (c.tipo === 'Senador') {
                    regionTipoCount[regionSimple].senadores++;
                } else {
                    regionTipoCount[regionSimple].diputados++;
                }
            });

            // Ordenar y obtener top datos
            const sortedPartidos = Object.entries(partidosCount).sort((a, b) => b[1] - a[1]);
            const sortedRegiones = Object.entries(regionesCount).sort((a, b) => b[1] - a[1]);
            const sortedPactos = Object.entries(pactosCount).sort((a, b) => b[1] - a[1]);

            // Crear gr√°fico de partidos (horizontal bar)
            const ctxPartidos = document.getElementById('chartPartidos').getContext('2d');
            if (charts.partidos) charts.partidos.destroy();
            charts.partidos = new Chart(ctxPartidos, {
                type: 'bar',
                data: {
                    labels: sortedPartidos.slice(0, 10).map(p => p[0]),
                    datasets: [{
                        label: 'N√∫mero de candidatos',
                        data: sortedPartidos.slice(0, 10).map(p => p[1]),
                        backgroundColor: 'rgba(0, 102, 204, 0.7)',
                        borderColor: 'rgba(0, 102, 204, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { display: false }
                        }
                    }
                }
            });

            // Crear gr√°fico de regiones (bar vertical)
            const ctxRegiones = document.getElementById('chartRegiones').getContext('2d');
            if (charts.regiones) charts.regiones.destroy();
            charts.regiones = new Chart(ctxRegiones, {
                type: 'bar',
                data: {
                    labels: sortedRegiones.map(r => r[0].length > 15 ? r[0].substring(0, 15) + '...' : r[0]),
                    datasets: [{
                        label: 'Total candidatos',
                        data: sortedRegiones.map(r => r[1]),
                        backgroundColor: 'rgba(213, 43, 30, 0.7)',
                        borderColor: 'rgba(213, 43, 30, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            ticks: {
                                autoSkip: false,
                                maxRotation: 45,
                                minRotation: 45,
                                font: { size: 10 }
                            }
                        },
                        y: { beginAtZero: true }
                    }
                }
            });

            // Crear gr√°fico de pactos (doughnut)
            const ctxPactos = document.getElementById('chartPactos').getContext('2d');
            if (charts.pactos) charts.pactos.destroy();
            charts.pactos = new Chart(ctxPactos, {
                type: 'doughnut',
                data: {
                    labels: sortedPactos.map(p => p[0]),
                    datasets: [{
                        data: sortedPactos.map(p => p[1]),
                        backgroundColor: [
                            'rgba(0, 102, 204, 0.7)',
                            'rgba(213, 43, 30, 0.7)',
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(255, 193, 7, 0.7)',
                            'rgba(156, 39, 176, 0.7)',
                            'rgba(255, 87, 34, 0.7)',
                            'rgba(0, 188, 212, 0.7)',
                            'rgba(96, 125, 139, 0.7)'
                        ],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { font: { size: 10 } }
                        }
                    }
                }
            });

            // Crear gr√°fico comparativo Senadores vs Diputados por regi√≥n
            const regionLabels = Object.keys(regionTipoCount).slice(0, 10);
            const ctxTipoRegion = document.getElementById('chartTipoRegion').getContext('2d');
            if (charts.tipoRegion) charts.tipoRegion.destroy();
            charts.tipoRegion = new Chart(ctxTipoRegion, {
                type: 'bar',
                data: {
                    labels: regionLabels.map(r => r.length > 12 ? r.substring(0, 12) + '...' : r),
                    datasets: [{
                        label: 'Senadores',
                        data: regionLabels.map(r => regionTipoCount[r].senadores),
                        backgroundColor: 'rgba(0, 102, 204, 0.7)',
                        borderColor: 'rgba(0, 102, 204, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Diputados',
                        data: regionLabels.map(r => regionTipoCount[r].diputados),
                        backgroundColor: 'rgba(213, 43, 30, 0.7)',
                        borderColor: 'rgba(213, 43, 30, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            ticks: {
                                autoSkip: false,
                                maxRotation: 45,
                                minRotation: 45,
                                font: { size: 10 }
                            }
                        },
                        y: { 
                            beginAtZero: true,
                            stacked: false
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { font: { size: 12 } }
                        }
                    }
                }
            });

            // Actualizar tablas de top datos
            updateTopStats(sortedPartidos, sortedRegiones, sortedPactos);
        }

        function updateChileMap() {
            // Contar candidatos por regi√≥n
            const regionData = {};
            
            allData.forEach(c => {
                const region = c.region;
                if (!regionData[region]) {
                    regionData[region] = {
                        total: 0,
                        senadores: 0,
                        diputados: 0,
                        partidos: new Set(),
                        pactos: new Set()
                    };
                }
                regionData[region].total++;
                if (c.tipo === 'Senador') {
                    regionData[region].senadores++;
                } else {
                    regionData[region].diputados++;
                }
                if (c.partido) regionData[region].partidos.add(c.partido);
                if (c.pacto) regionData[region].pactos.add(c.pacto);
            });

            // Funci√≥n para obtener color seg√∫n cantidad
            function getColorByCount(count) {
                if (count <= 30) return '#E3F2FD';
                if (count <= 60) return '#90CAF9';
                if (count <= 90) return '#42A5F5';
                if (count <= 120) return '#1976D2';
                return '#0D47A1';
            }

            // Actualizar cada regi√≥n en el mapa
            document.querySelectorAll('.map-region').forEach(regionElement => {
                const regionKey = regionElement.dataset.region;
                
                // Buscar la regi√≥n en los datos
                let matchedRegion = null;
                let matchedData = null;
                
                Object.keys(regionData).forEach(fullRegionName => {
                    if (fullRegionName.includes(regionKey)) {
                        matchedRegion = fullRegionName;
                        matchedData = regionData[fullRegionName];
                    }
                });
                
                if (matchedData) {
                    // Actualizar el contador
                    const countElement = regionElement.querySelector('.region-count');
                    if (countElement) {
                        countElement.textContent = matchedData.total;
                    }
                    
                    // Actualizar el color
                    const regionBox = regionElement.querySelector('.region-box');
                    if (regionBox) {
                        regionBox.style.background = getColorByCount(matchedData.total);
                        
                        // Si hay muchos candidatos, cambiar color del texto
                        if (matchedData.total > 90) {
                            regionBox.style.color = 'white';
                            const count = regionBox.querySelector('.region-count');
                            if (count) {
                                count.style.color = 'white';
                                count.style.background = 'rgba(255,255,255,0.2)';
                            }
                        }
                    }
                    
                    // Agregar evento click
                    regionElement.onclick = function() {
                        // Quitar clase active de todas las regiones
                        document.querySelectorAll('.region-box').forEach(box => {
                            box.classList.remove('active');
                        });
                        
                        // Agregar clase active a la regi√≥n seleccionada
                        const box = regionElement.querySelector('.region-box');
                        if (box) box.classList.add('active');
                        
                        // Mostrar detalles
                        showRegionDetails(matchedRegion, matchedData);
                    };
                }
            });
        }

        function showRegionDetails(regionName, data) {
            const regionSimple = regionName.replace('REGI√ìN DE ', '').replace('REGI√ìN DEL ', '').replace('LA ', '');
            const detailsBox = document.getElementById('regionDetails');
            
            if (detailsBox) {
                detailsBox.innerHTML = `
                    <h4>üìç ${regionSimple}</h4>
                    <div class="region-stats-grid">
                        <div class="region-stat">
                            <div class="region-stat-value">${data.total}</div>
                            <div class="region-stat-label">Total</div>
                        </div>
                        <div class="region-stat">
                            <div class="region-stat-value" style="color: #0066CC;">${data.senadores}</div>
                            <div class="region-stat-label">Senadores</div>
                        </div>
                        <div class="region-stat">
                            <div class="region-stat-value" style="color: #D52B1E;">${data.diputados}</div>
                            <div class="region-stat-label">Diputados</div>
                        </div>
                        <div class="region-stat">
                            <div class="region-stat-value">${((data.total / allData.length) * 100).toFixed(1)}%</div>
                            <div class="region-stat-label">Del Total</div>
                        </div>
                    </div>
                    <p style="margin-top: 15px; color: #666;">
                        <strong>${data.partidos.size}</strong> partidos y <strong>${data.pactos.size}</strong> pactos presentes
                    </p>
                `;
            }
        }

        function updateTopStats(partidos, regiones, pactos) {
            const total = allData.length;
            
            // Top Partidos
            document.getElementById('topPartidos').innerHTML = partidos.slice(0, 5).map(p => `
                <div class="detail-item">
                    <span class="detail-label">${p[0]}</span>
                    <span class="detail-value">${p[1]} candidatos</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${(p[1] / total * 100).toFixed(1)}%"></div>
                </div>
            `).join('');
            
            // Top Regiones
            document.getElementById('topRegiones').innerHTML = regiones.slice(0, 5).map(r => `
                <div class="detail-item">
                    <span class="detail-label">${r[0]}</span>
                    <span class="detail-value">${r[1]} candidatos</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${(r[1] / total * 100).toFixed(1)}%"></div>
                </div>
            `).join('');
            
            // Top Pactos
            document.getElementById('topPactos').innerHTML = pactos.slice(0, 5).map(p => `
                <div class="detail-item">
                    <span class="detail-label">${p[0]}</span>
                    <span class="detail-value">${p[1]} candidatos</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${(p[1] / total * 100).toFixed(1)}%"></div>
                </div>
            `).join('');
        }

        function updateFiltersOptions() {
            // Obtener valores √∫nicos
            const pactos = [...new Set(allData.map(c => c.pacto))].filter(Boolean).sort();
            const partidos = [...new Set([...allData.map(c => c.partido), ...allData.map(c => c.partidoAsociado)])].filter(Boolean).sort();
            const regiones = [...new Set(allData.map(c => c.region))].filter(Boolean).sort();
            const ubicaciones = [...new Set(allData.map(c => c.ubicacion))].filter(Boolean).sort((a, b) => parseInt(a) - parseInt(b));

            // Actualizar selectores
            const pactoSelect = document.querySelector('.filter-select[onchange*="pacto"]');
            pactoSelect.innerHTML = '<option value="">Todos los pactos</option>' + 
                pactos.map(p => `<option value="${p}">${p}</option>`).join('');

            const partidoSelect = document.querySelector('.filter-select[onchange*="partido"]');
            partidoSelect.innerHTML = '<option value="">Todos los partidos</option>' + 
                partidos.map(p => `<option value="${p}">${p}</option>`).join('');

            const regionSelect = document.querySelector('.filter-select[onchange*="region"]');
            regionSelect.innerHTML = '<option value="">Todas las regiones</option>' + 
                regiones.map(r => `<option value="${r}">${r.replace('REGI√ìN DE ', '').replace('REGI√ìN DEL ', '')}</option>`).join('');

            const ubicacionSelect = document.querySelector('.filter-select[onchange*="ubicacion"]');
            ubicacionSelect.innerHTML = '<option value="">Todos</option>' + 
                ubicaciones.map(u => `<option value="${u}">${u}</option>`).join('');
        }

        function setTab(tab) {
            activeTab = tab;
            currentPage = 1;
            
            // Actualizar UI de tabs
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            applyFilters();
        }

        function updateFilter(key, value) {
            filters[key] = value;
            currentPage = 1;
            applyFilters();
        }

        function applyFilters() {
            filteredData = allData.filter(c => {
                if (activeTab === 'senadores' && c.tipo !== 'Senador') return false;
                if (activeTab === 'diputados' && c.tipo !== 'Diputado') return false;
                if (filters.search && !c.nombre.toLowerCase().includes(filters.search.toLowerCase())) return false;
                if (filters.pacto && c.pacto !== filters.pacto) return false;
                if (filters.partido && c.partido !== filters.partido && c.partidoAsociado !== filters.partido) return false;
                if (filters.region && c.region !== filters.region) return false;
                if (filters.ubicacion && c.ubicacion !== filters.ubicacion) return false;
                return true;
            });

            renderCandidates();
        }

        function renderCandidates() {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const page = filteredData.slice(start, end);

            document.getElementById('resultsInfo').innerHTML = 
                `Mostrando ${Math.min(start + 1, filteredData.length)}-${Math.min(end, filteredData.length)} de ${filteredData.length} candidatos`;

            document.getElementById('candidatesGrid').innerHTML = page.map(c => {
                const tipo = c.tipo.toLowerCase();
                const nombre = c.nombre.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                
                return `
                    <div class="candidate-card ${tipo}">
                        <h3 class="candidate-name">
                            ${nombre}
                            <span class="cargo-badge ${tipo}">${c.tipo}</span>
                        </h3>
                        ${c.partido ? `<span class="candidate-party">${c.partido}</span>` : ''}
                        ${c.partidoAsociado ? `<span class="candidate-party">${c.partidoAsociado}</span>` : ''}
                        <div class="candidate-info">
                            <p>üèõÔ∏è <strong>Pacto:</strong> ${c.pacto || 'No especificado'}</p>
                            <p>üìç <strong>Regi√≥n:</strong> ${(c.region || '').replace('REGI√ìN DE ', '').replace('REGI√ìN DEL ', '') || 'No especificada'}</p>
                            <p>üìä <strong>${c.tipo === 'Diputado' ? 'Distrito' : 'Circunscripci√≥n'}:</strong> ${c.ubicacion || 'No especificado'}</p>
                            ${c.orden ? `<p>üìã <strong>Orden:</strong> ${c.orden}</p>` : ''}
                        </div>
                    </div>
                `;
            }).join('');

            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (totalPages <= 1) {
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            let html = `<button onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‚Üê Anterior</button>`;
            
            for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                html += `<button onclick="goToPage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
            }
            
            html += `<button onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Siguiente ‚Üí</button>`;
            
            document.getElementById('pagination').innerHTML = html;
        }

        function goToPage(page) {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderCandidates();
                window.scrollTo(0, 0);
            }
        }
    </script>
</body>
</html>